(()=>{async function r(){let s="",{data:e,error:t}=await supabase.from("comment").select("*").order("id",{ascending:!1});if(t)console.log(t);else{for(e.forEach(e=>{var{id:e,name:t,comment:a}=e;s+=`<li class="comments">
                        <strong>${t}</strong>
                        <p>${a}</p>
                        <button type="button" data-action="${e}">
                            <svg data-action="${e}" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8.25,0,32,23.75,55.75,0,64,8.25,40.25,32,64,55.75,55.75,64,32,40.25,8.25,64,0,55.75,23.75,32,0,8.25Z" data-action="${e}"></path>
                            </svg>
                        </button>
                    </li>`});a.hasChildNodes();)a.removeChild(a.firstChild);a.insertAdjacentHTML("beforeend",s)}}const e=supabase["createClient"],a=document.querySelector("#commentArea"),n=document.querySelector(".comment-wrap");supabase=e("https://vhrvlqeneibkmnpxavfi.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZocnZscWVuZWlia21ucHhhdmZpIiwicm9sZSI6ImFub24iLCJpYXQiOjE2NTY0ODUwODQsImV4cCI6MTk3MjA2MTA4NH0.Rixg9sFOIrlM0PwWBsGDbO0rj9XtH0mv0ZEMGJUJN70");r(),a.addEventListener("click",async e=>{e=e.target;"path"!==e.tagName&&"svg"!==e.tagName&&"BUTTON"!==e.tagName||(n.classList.add("delete"),n.dataset.cmtid=e.dataset.action)}),n.addEventListener("click",async e=>{e=e.target;"btn-popup"===e.className&&n.classList.add("insert"),"comment-popup"===e.className&&(n.classList.remove("insert"),n.classList.remove("delete"))}),document.querySelector("#insertFrm").addEventListener("submit",async e=>{e.preventDefault();var t=e.target,a=t.id.value,s=t.pw.value,t=t.ta.value;try{if(""===a||""===s||""===t)return void alert("다시 작성해주세요!");var{}=await supabase.from("comment").insert([{name:a,password:s,comment:t}]);await r()}catch(e){console.error(e)}n.classList.remove("insert"),e.target.reset()}),document.querySelector("#deleteFrm").addEventListener("submit",async e=>{e.preventDefault();var t=e.target.pw.value,t=(await supabase.from("comment").delete().match({id:n.dataset.cmtid,password:t}))["data"];console.log(t.length),0<t.length?await r():alert("비밀번호가 맞지 않아요!"),n.classList.remove("delete"),e.target.reset()})})();